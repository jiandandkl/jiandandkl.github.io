<!DOCTYPE html>
<html lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.3 -->

    <!-- Title -->
    
    <title>
        
            webpack热加载优化及vite踩坑记录 | 
        
        dujun blog
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="jiandandkl">
    <meta name="description" content>
    <meta name="keywords" content>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" sizes="192x192" href="/img/favicon.ico">
    <link rel="apple-touch-icon" href="/img/favicon.ico">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="dujun blog">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://jiandandkl.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="webpack热加载优化及vite踩坑记录 | dujun blog">
    <meta property="og:description" content>
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", SimSun, sans-serif;;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

  #post-content pre {
    background: #272822;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css"></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#一、背景"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、背景</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#二、webpack4-的优化"><span class="post-toc-number">2.</span> <span class="post-toc-text">二、webpack4 的优化</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#三、迁移至-Vite"><span class="post-toc-number">3.</span> <span class="post-toc-text">三、迁移至 Vite</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-vite-简介"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">1. vite 简介</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-迁移步骤"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">2. 迁移步骤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-遇到的问题"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">3. 遇到的问题</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-1-Cannot-find-module-‘worker-threads’"><span class="post-toc-number">3.3.0.1.</span> <span class="post-toc-text">3.1 Cannot find module ‘worker_threads’</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-2-Unknown-theme-type-undefined-name-undefined"><span class="post-toc-number">3.3.0.2.</span> <span class="post-toc-text">3.2 Unknown theme type: undefined, name: undefined</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-3-require-is-not-defined，"><span class="post-toc-number">3.3.0.3.</span> <span class="post-toc-text">3.3 require is not defined，</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-4-error-No-matching-export-in-“node-modules-antv-util-esm-index-js”-for-import-“max”"><span class="post-toc-number">3.3.0.4.</span> <span class="post-toc-text">3.4 error: No matching export in “node_modules/@antv/util/esm/index.js” for import “max”</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-5-The-requested-module-‘xxx’-does-not-provide-an-export-named-‘xx’"><span class="post-toc-number">3.3.0.5.</span> <span class="post-toc-text">3.5 The requested module ‘xxx’ does not provide an export named ‘xx’</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-6-Failed-to-fetch-dynamically-imported-module"><span class="post-toc-number">3.3.0.6.</span> <span class="post-toc-text">3.6 Failed to fetch dynamically imported module</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-7-process-is-not-defined"><span class="post-toc-number">3.3.0.7.</span> <span class="post-toc-text">3.7  process is not defined</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-8-antd-的日期组件只显示了今天"><span class="post-toc-number">3.3.0.8.</span> <span class="post-toc-text">3.8 antd 的日期组件只显示了今天</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-9-import-meta-glob-webpack-build-报错"><span class="post-toc-number">3.3.0.9.</span> <span class="post-toc-text">3.9 import.meta.glob webpack build 报错</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-10-import-meta-url-webpack-build-报错"><span class="post-toc-number">3.3.0.10.</span> <span class="post-toc-text">3.10 import.meta.url webpack build 报错</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-11-Dynamic-require-of-“xxx-css”-is-not-supported"><span class="post-toc-number">3.3.0.11.</span> <span class="post-toc-text">3.11 Dynamic require of “xxx.css” is not supported</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-12-The-requested-module-‘-node-modules-vite-react-intl-js-v-94a2fd86’-does-not-provide-an-export-named-‘intlShape’"><span class="post-toc-number">3.3.0.12.</span> <span class="post-toc-text">3.12 The requested module ‘/node_modules/.vite/react-intl.js?v=94a2fd86’ does not provide an export named ‘intlShape’</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-13-GET-http-localhost-9021-id-dayjs-moment-net-ERR-ABORTED-404-Not-Found"><span class="post-toc-number">3.3.0.13.</span> <span class="post-toc-text">3.13 GET http://localhost:9021/@id/dayjs/moment net::ERR_ABORTED 404 (Not Found)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-14-打开页面后发出了-2000-多个-http-请求，完全渲染完成依然需要-9s"><span class="post-toc-number">3.3.0.14.</span> <span class="post-toc-text">3.14 打开页面后发出了 2000 多个 http 请求，完全渲染完成依然需要 9s</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-15-vite-一直-reload，new-dependencies-的提示"><span class="post-toc-number">3.3.0.15.</span> <span class="post-toc-text">3.15 vite 一直 reload，new dependencies .. 的提示</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3-16-Failed-to-load-module-script-Expected-a-JavaScript-module-script-but-the-server-responded-with-a-MIME-type-of-quot-text-html-quot-Strict-MIME-type-checking-is-enforced-for-module-scripts-per-HTML-spec"><span class="post-toc-number">3.3.0.16.</span> <span class="post-toc-text">3.16 Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of &quot;text/html&quot;. Strict MIME type checking is enforced for module scripts per HTML spec.</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#四、效果"><span class="post-toc-number">4.</span> <span class="post-toc-text">四、效果</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#五、总结"><span class="post-toc-number">5.</span> <span class="post-toc-text">五、总结</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#六、参考"><span class="post-toc-number">6.</span> <span class="post-toc-text">六、参考</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
  <!-- Paradox Post Header -->
  
    
      <!-- Random Thumbnail -->
      <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50" data-original="">
        <script>
  var randomNum = Math.floor(Math.random() * 19 + 1);

  if (!$('.post_thumbnail-random').attr('data-original')) {
    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
  }
  $('.post_thumbnail-random').addClass('lazy');
</script>

      
      
        <p class="article-headline-p">
          webpack热加载优化及vite踩坑记录
        </p>
      </div>
    

    


                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

  <!-- Author Avatar -->
  <div id="author-avatar">
    <img src="https://avatars.githubusercontent.com/u/16009933?v=4" width="44px" height="44px" alt="Author Avatar" />
  </div>
  <!-- Author Name & Date -->
  <div>
    <strong>
      <a href="https://github.com/jiandandkl">
        jiandandkl</a>
    </strong>
    <span>
      5月 12, 2022</span>
  </div>
  <div class="section-spacer"></div>

  <!-- Favorite -->
  <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->
  <span id="busuanzi_container_page_pv" style="margin-right: 10%">
    本文总阅读量<span id="busuanzi_value_page_pv"></span>次
  </span>
  <!-- Qrcode -->
  
  <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
  </button>
  <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">
      在其它设备中阅读本文章
    </li>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAAEOCAAAAABd2qZ5AAADgElEQVR42u3aQZIiMQwEQP7/6d3rRmwAVZINHLJPEz0z7nZyKCTr8cf1z/VAgAMHDhw4cODAgQPHD3M84uvZ379e5+lLPFnh2c/Jyu1ecODAgQPHPY43UfT/EuW22022WKu94MCBAweOaxyvX27D1G7+FFmyFxw4cODA8V2OZy+9L9WKdt6o8MOBAwcOHL/P8abpVhZU+6fgwIEDB45f48hfur2Tx3CyZltqXuyV4sCBAweOQwMNv/zzF+Y7cODAgQPH4pqVTLPRullZWO8IBw4cOHAc5UiGFc6OFOSHUldidVbR4sCBAweOmKM9pNn8bz760DYB22E+HDhw4MBxmyM/Fnp9RJRH8uaQKYne4ogLBw4cOHBc4JhFWj64MFttz3T9ewcOHDhw4Hg50DCL0s0ARNJAzCO5Ledw4MCBA8dtjk3TbRacs8jPn16XcDhw4MCB4xBHvURwP4/b/XhEO6iHAwcOHDhuc7SNubxR2FK2h2Htl4Ph9w4cOHDgwLE4wd8f8CSNv9VwW1AEFqvhwIEDB46jHJvgbLHa8iy/nx9i4cCBAweO73LkIw557OXos7C/GLQ4cODAgSPmaBfKYzhp881GFvJRuTe/xYEDBw4cRznyaGwLpLqUGhVg7YUDBw4cOH6Bo20jtjGcD+S1jUIcOHDgwPEtjjz2ZqXd601uAr4dp8CBAwcOHJ/neB1ReaTtD7dOHUS9+Rhw4MCBA8dRjrzsmYVcvpkcJWEqCkUcOHDgwHGBI9n8t9qF7YbzjxMHDhw4cNzgGDbUFgc/ydPzBuVmhAIHDhw4cHyGYz+CsHm5UwVbcQcHDhw4cBzlmJVebXC2TcPNG9YtThw4cODAcYGjfcymebc/6MrfPwpvHDhw4MBxlKMdUJhF2izCzzYrnz4FBw4cOHBc45i9aLKBtiHYrnOshMOBAwcOHBe6YZsBhU3x1sb2sXEKHDhw4MBxlKO9ZjSbA6rZh3SgOYgDBw4cOA4dO7XHSPtG4aaoSwIYBw4cOHB8nqONzHyTp8YXNkdfb56OAwcOHDiucbRh1pZt7Vhe3lLMvyIUQYsDBw4cOD7CMQyzBXo7vlAXmThw4MCB4yc5ZnfyEN20JofNQRw4cODAsebYjCbMInkz9DA7lMKBAwcOHJ/h2A80tChJlOalYEuDAwcOHDjucbhw4MCBAwcOHDhw4MDxY9df1OgpkkVyErQAAAAASUVORK5CYII=">
  </ul>
  

  <!-- Tags (bookmark) -->
  
  <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">bookmark</i>
    <span class="visuallyhidden">bookmark</span>
  </button>
  <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
    <li class="mdl-menu__item">
      
  </ul>
  

  <!-- Share -->
  <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>
                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h2 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h2><p>三年前的老项目，技术栈是 react + webpack4，融合了很多模块，项目巨大无比，每次更改代码都得等待 20s 左右，实在有点怀疑人生。接手项目的第一天就想有机会一定要优化，随着对项目的了解和工作节奏的适应，最近开始着手优化项目热加载。</p>
<h2 id="二、webpack4-的优化"><a href="#二、webpack4-的优化" class="headerlink" title="二、webpack4 的优化"></a>二、webpack4 的优化</h2><p>已经做的优化</p>
<ul>
<li>DllPlugin</li>
<li>babel-loader 设置缓存</li>
</ul>
<p>尝试做的优化</p>
<ul>
<li>react-hot-loader</li>
<li>hard-source-webpack-plugin</li>
<li>react-refresh</li>
</ul>
<p>试了若干种方案后，效果甚微；后来就某个问题场外求助时，被安利了 esbuild 和 Vite，看了 esbuild 首页夸张的数据对比，抱着将信将疑的态度尝试了 Vite（真香）。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ce5b90db06a2497fb13c76732578348c~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<h2 id="三、迁移至-Vite"><a href="#三、迁移至-Vite" class="headerlink" title="三、迁移至 Vite"></a>三、迁移至 Vite</h2><h3 id="1-vite-简介"><a href="#1-vite-简介" class="headerlink" title="1. vite 简介"></a>1. vite 简介</h3><p>Vite 对于第三方库使用 esbuild 预构建依赖，Esbuild 使用 Go 编写，速度比以 JavaScript 编写的打包器预构建依赖快 10-100 倍；以原生 ESM 方式提供源码，没有了 webpack 的编译过程，对 webpack 可以说是降维打击…</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/382d39de7cb240deb5cef26cfb0af956~tplv-k3u1fbpfcp-zoom-1.image" alt><br>webpack 团队成员的中文回复..</p>
<h3 id="2-迁移步骤"><a href="#2-迁移步骤" class="headerlink" title="2. 迁移步骤"></a>2. 迁移步骤</h3><p>2.1 根目录创建 Vite.config.js，完整配置：</p>
<pre class=" language-javascript"><code class="language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> reactRefresh <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-react-refresh'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> antdDayjs <span class="token keyword">from</span> <span class="token string">'antd-dayjs-vite-plugin'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> ttt <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token function">reactRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">// 处理antd日期组件只展示今天的问题</span>
    <span class="token function">antdDayjs</span><span class="token punctuation">(</span><span class="token punctuation">{</span> preset<span class="token punctuation">:</span> <span class="token string">'antdv3'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  base<span class="token punctuation">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span>
  resolve<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'.mjs'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.tsx'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    alias<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> find<span class="token punctuation">:</span> <span class="token string">'@src'</span><span class="token punctuation">,</span> replacement<span class="token punctuation">:</span> ’xxxx <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> find<span class="token punctuation">:</span> <span class="token string">'react-native'</span><span class="token punctuation">,</span> replacement<span class="token punctuation">:</span> <span class="token string">'react-native-web'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> find<span class="token punctuation">:</span> <span class="token string">'@ant-design/icons/lib/dist'</span><span class="token punctuation">,</span> replacement<span class="token punctuation">:</span> <span class="token string">'@ant-design/icons/lib/index.es.js'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimizeDeps<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// exclude: ['bizcharts']</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  css<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    preprocessorOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      less<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        javascriptEnabled<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  server<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    port<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    host<span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    open<span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    proxy<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>
        changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  define<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'process.env'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 计划只在开发环境使用,写死了dev</span>
      NODE_ENV<span class="token punctuation">:</span> <span class="token string">'development'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>2.2 复制 index.html 至根目录</p>
<p>添加 <code>&lt;script type=&quot;module&quot; src=&quot;/src/Main.jsx&quot;&gt;&lt;/script&gt;</code></p>
<p>2.3 package.json 添加启动命令</p>
<p><code>&quot;start:Vite&quot;: &quot;Vite&quot;</code></p>
<p>至此 Vite 配置已告一段落，可以尝试跑下 “start:Vite”: “Vite”，会发现各种报错，下面开始填坑之旅。</p>
<blockquote>
<p>2.4 为开发环境为 vite，线上保持 webpack 的兼容处理</p>
</blockquote>
<p>2.4 让 webpack 处理 import.meta.globEager 和 import.meta.glob</p>
<pre class=" language-js"><code class="language-js">test<span class="token punctuation">:</span> <span class="token regex">/.(js|mjs|jsx|ts|tsx)$/</span><span class="token punctuation">,</span>
use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> loader<span class="token punctuation">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'@open-wc/webpack-import-meta-loader'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    loader<span class="token punctuation">:</span> require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'babel-loader'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-preset-vite'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/plugin-syntax-import-meta'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre>
<h3 id="3-遇到的问题"><a href="#3-遇到的问题" class="headerlink" title="3. 遇到的问题"></a>3. 遇到的问题</h3><h5 id="3-1-Cannot-find-module-‘worker-threads’"><a href="#3-1-Cannot-find-module-‘worker-threads’" class="headerlink" title="3.1 Cannot find module ‘worker_threads’"></a>3.1 Cannot find module ‘worker_threads’</h5><p>node ≥ 12</p>
<h5 id="3-2-Unknown-theme-type-undefined-name-undefined"><a href="#3-2-Unknown-theme-type-undefined-name-undefined" class="headerlink" title="3.2 Unknown theme type: undefined, name: undefined"></a>3.2 Unknown theme type: undefined, name: undefined</h5><pre class=" language-js"><code class="language-js">alias<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'@ant-design/icons/lib/dist'</span><span class="token punctuation">:</span> <span class="token string">'@ant-design/icons/lib/index.es.js'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre>
<h5 id="3-3-require-is-not-defined，"><a href="#3-3-require-is-not-defined，" class="headerlink" title="3.3 require is not defined，"></a>3.3 require is not defined，</h5><p>如 backgroundimage:<code>url(${require(&#39;common/Asset/icon${item.index_page}.svg&#39;)})</code></p>
<p>可以写个获取图片的工具方法</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> getImageUrl <span class="token operator">=</span> <span class="token punctuation">(</span>imageName<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 因为import.meta.url会加上本模块所在的目录 src/utils,所以加上../../</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`${new URL(`</span></span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>$<span class="token punctuation">{</span>imagePath<span class="token punctuation">}</span><span class="token template-string"><span class="token string">`, import.meta.url).href}`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
backgroundimage<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`url(${getImageUrl(`</span></span>$<span class="token punctuation">{</span>item<span class="token punctuation">.</span>index_page<span class="token punctuation">}</span><span class="token punctuation">.</span>svg<span class="token template-string"><span class="token string">`)})`</span></span><span class="token punctuation">;</span></code></pre>
<h5 id="3-4-error-No-matching-export-in-“node-modules-antv-util-esm-index-js”-for-import-“max”"><a href="#3-4-error-No-matching-export-in-“node-modules-antv-util-esm-index-js”-for-import-“max”" class="headerlink" title="3.4 error: No matching export in “node_modules/@antv/util/esm/index.js” for import “max”"></a>3.4 error: No matching export in “node_modules/@antv/util/esm/index.js” for import “max”</h5><p>@antv/util 升级到 2.0.17</p>
<h5 id="3-5-The-requested-module-‘xxx’-does-not-provide-an-export-named-‘xx’"><a href="#3-5-The-requested-module-‘xxx’-does-not-provide-an-export-named-‘xx’" class="headerlink" title="3.5 The requested module ‘xxx’ does not provide an export named ‘xx’"></a>3.5 The requested module ‘xxx’ does not provide an export named ‘xx’</h5><p>exports 改为 export</p>
<h5 id="3-6-Failed-to-fetch-dynamically-imported-module"><a href="#3-6-Failed-to-fetch-dynamically-imported-module" class="headerlink" title="3.6 Failed to fetch dynamically imported module"></a>3.6 Failed to fetch dynamically imported module</h5><p>改用 import.meta.glob</p>
<h5 id="3-7-process-is-not-defined"><a href="#3-7-process-is-not-defined" class="headerlink" title="3.7  process is not defined"></a>3.7  process is not defined</h5><pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// vite.config.js</span>
define<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">'process.env'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    NODE_ENV<span class="token punctuation">:</span> <span class="token string">'development'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="3-8-antd-的日期组件只显示了今天"><a href="#3-8-antd-的日期组件只显示了今天" class="headerlink" title="3.8 antd 的日期组件只显示了今天"></a>3.8 antd 的日期组件只显示了今天</h5><p>Vite.config.js 添加 plugins: [antdDayjs({ preset: ‘antdv3’ })]  (非 v3 版本不用 preset 参数）</p>
<h5 id="3-9-import-meta-glob-webpack-build-报错"><a href="#3-9-import-meta-glob-webpack-build-报错" class="headerlink" title="3.9 import.meta.glob webpack build 报错"></a>3.9 import.meta.glob webpack build 报错</h5><pre class=" language-js"><code class="language-js">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev babel<span class="token operator">-</span>preset<span class="token operator">-</span>vite @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>syntax<span class="token operator">-</span><span class="token keyword">import</span><span class="token operator">-</span>meta
presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-preset-vite'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/plugin-syntax-import-meta'</span><span class="token punctuation">]</span></code></pre>
<h5 id="3-10-import-meta-url-webpack-build-报错"><a href="#3-10-import-meta-url-webpack-build-报错" class="headerlink" title="3.10 import.meta.url webpack build 报错"></a>3.10 import.meta.url webpack build 报错</h5><p>添加<code>@open-wc/webpack-import-meta-loader</code></p>
<h5 id="3-11-Dynamic-require-of-“xxx-css”-is-not-supported"><a href="#3-11-Dynamic-require-of-“xxx-css”-is-not-supported" class="headerlink" title="3.11 Dynamic require of “xxx.css” is not supported"></a>3.11 Dynamic require of “xxx.css” is not supported</h5><p>改了 yimi-form-components 的样式。。。。</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// require("antd/lib/table/style/index.css");</span>
<span class="token keyword">import</span> <span class="token string">"antd/lib/table/style/index.css"</span><span class="token punctuation">;</span></code></pre>
<h5 id="3-12-The-requested-module-‘-node-modules-vite-react-intl-js-v-94a2fd86’-does-not-provide-an-export-named-‘intlShape’"><a href="#3-12-The-requested-module-‘-node-modules-vite-react-intl-js-v-94a2fd86’-does-not-provide-an-export-named-‘intlShape’" class="headerlink" title="3.12 The requested module ‘/node_modules/.vite/react-intl.js?v=94a2fd86’ does not provide an export named ‘intlShape’"></a>3.12 The requested module ‘/node_modules/.vite/react-intl.js?v=94a2fd86’ does not provide an export named ‘intlShape’</h5><p>这个问题很奇怪，’intlShape’是 react-intl 的一个 interface，在 vite 编译后的文件里确实没有，于是想看是哪个组件使用了，一个个试了发现是有的组件引用了’intlShape’但是没有使用，把这样的’intlShape’删除后项目就可以启动了..</p>
<h5 id="3-13-GET-http-localhost-9021-id-dayjs-moment-net-ERR-ABORTED-404-Not-Found"><a href="#3-13-GET-http-localhost-9021-id-dayjs-moment-net-ERR-ABORTED-404-Not-Found" class="headerlink" title="3.13 GET http://localhost:9021/@id/dayjs/moment net::ERR_ABORTED 404 (Not Found)"></a>3.13 GET <a href="http://localhost:9021/@id/dayjs/moment" target="_blank" rel="noopener">http://localhost:9021/@id/dayjs/moment</a> net::ERR_ABORTED 404 (Not Found)</h5><p>组件中有 <code>import moment from &#39;moment/moment&#39;;</code>改为 <code>import moment from &#39;moment‘;</code>即可</p>
<h5 id="3-14-打开页面后发出了-2000-多个-http-请求，完全渲染完成依然需要-9s"><a href="#3-14-打开页面后发出了-2000-多个-http-请求，完全渲染完成依然需要-9s" class="headerlink" title="3.14 打开页面后发出了 2000 多个 http 请求，完全渲染完成依然需要 9s"></a>3.14 打开页面后发出了 2000 多个 http 请求，完全渲染完成依然需要 9s</h5><p>查看了下请求的文件，大多是 swagger 生成的 services 文件，因 services 是通过一个文件 export 出来的，所以使用的时候就是引用了所有的 services 文件，查看了 services 下确实有 1800 多个文件。</p>
<p>看了 vite 文档中有介绍：</p>
<blockquote>
<p>一些包将它们的 ES 模块构建作为许多单独的文件相互导入。例如，<a href="https://unpkg.com/browse/lodash-es/" target="_blank" rel="noopener">lodash-es 有超过 600 个内置模块</a>！当我们执行 import { debounce } from ‘lodash-es’ 时，浏览器同时发出 600 多个 HTTP 请求！尽管服务器在处理这些请求时没有问题，但大量的请求会在浏览器端造成网络拥塞，导致页面的加载速度相当慢。通过预构建 lodash-es 成为一个模块，我们就只需要一个 HTTP 请求了！</p>
</blockquote>
<p>所有可以把类似的模块加入预构建，比如这里的 services，还有翻译相关的</p>
<pre class=" language-js"><code class="language-js">optimizeDeps<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"@src/services"</span><span class="token punctuation">,</span> <span class="token string">"@src/Locales/zh_CN"</span><span class="token punctuation">,</span> <span class="token string">"@src/Locales/en_US"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h5 id="3-15-vite-一直-reload，new-dependencies-的提示"><a href="#3-15-vite-一直-reload，new-dependencies-的提示" class="headerlink" title="3.15 vite 一直 reload，new dependencies .. 的提示"></a>3.15 vite 一直 reload，new dependencies .. 的提示</h5><p>由于动态 import，预构建可能在项目启动后继续发生，但避免 vite.config.js 手动配置多个依赖，使用 vite-plugin-optimize-persist 插件可以把配置写到 package.json\</p>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// vite.config.ts</span>
<span class="token keyword">import</span> OptimizationPersist <span class="token keyword">from</span> <span class="token string">"vite-plugin-optimize-persist"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> PkgConfig <span class="token keyword">from</span> <span class="token string">"vite-plugin-package-config"</span><span class="token punctuation">;</span>

plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">PkgConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">OptimizationPersist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<h5 id="3-16-Failed-to-load-module-script-Expected-a-JavaScript-module-script-but-the-server-responded-with-a-MIME-type-of-quot-text-html-quot-Strict-MIME-type-checking-is-enforced-for-module-scripts-per-HTML-spec"><a href="#3-16-Failed-to-load-module-script-Expected-a-JavaScript-module-script-but-the-server-responded-with-a-MIME-type-of-quot-text-html-quot-Strict-MIME-type-checking-is-enforced-for-module-scripts-per-HTML-spec" class="headerlink" title="3.16 Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of &quot;text/html&quot;. Strict MIME type checking is enforced for module scripts per HTML spec."></a>3.16 <code>Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of &quot;text/html&quot;. Strict MIME type checking is enforced for module scripts per HTML spec.</code></h5><p>(后来生产也用 vite 了,补下)</p>
<p>因为用到了 cdn,需要在 vite.config.js 里判断是否生产环境,如果是则 base 添加 cdn 的前缀</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">export default ({ mode }) => {
  return defineConfig({
    ...
    base:
      !process.env.env || process.env.env === 'development'
        ? './'
        : 'https://static.yximgs.com/kos/nlav10562/is-budget-h5-fe/static/',
  })
}</code></pre>
<h2 id="四、效果"><a href="#四、效果" class="headerlink" title="四、效果"></a>四、效果</h2><table>
<thead>
<tr>
<th></th>
<th>webpack</th>
<th>Vite</th>
</tr>
</thead>
<tbody><tr>
<td>第一次启动</td>
<td>45s</td>
<td><code>20s</code></td>
</tr>
<tr>
<td>第二次启动</td>
<td>45s</td>
<td><code>1s</code></td>
</tr>
<tr>
<td>热加载</td>
<td>20s</td>
<td><code>1s</code></td>
</tr>
</tbody></table>
<h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><p>计划是对 webpack 做些优化的，但试了多种方法都没啥效果，所以不如直接上 Vite，<del>投入的时间差不多</del>（后面陆续填了好多坑），但收获的开发体验是极致的。</p>
<h2 id="六、参考"><a href="#六、参考" class="headerlink" title="六、参考"></a>六、参考</h2><p><a href="https://juejin.cn/post/6844904071736852487" target="_blank" rel="noopener">玩转 webpack，使你的打包速度提升 90%
</a></p>
<p><a href="https://cn.Vitejs.dev" target="_blank" rel="noopener">vite 官方文档</a></p>
<p><a href="https://www.cnblogs.com/EnSnail/p/15707038.html" target="_blank" rel="noopener">vue-cli3 vue2 保留 webpack 支持 vite 成功实践</a></p>
<p><a href="https://juejin.cn/post/7005479358085201957" target="_blank" rel="noopener">6 年的老项目迁移 vite2，提速几十倍，真香
</a></p>
<p><a href="https://juejin.cn/post/6951557699079569422" target="_blank" rel="noopener">vite 动态 import 引入打包报错解决方案
</a></p>
<p><a href="https://ssh-blog.vercel.app/812799294" target="_blank" rel="noopener">浅谈 Vite 2.0 原理，依赖预编译，插件机制是如何兼容 Rollup 的？</a></p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    




    <!-- 使用 DISQUS -->
    <div id="disqus-comment">
        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = 'https://jiandandkl.github.io/2022/05/12/webpack热加载优化及vite踩坑记录/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'https://jiandandkl.github.io/2022/05/12/webpack热加载优化及vite踩坑记录/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    queue.offer(function() {
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document;
                var s = d.createElement('script');
                s.src = '//jiandandkl.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        });
</script>

    </div>
    <style>
        #disqus-comment{
            background-color: #eee;
            padding: 2pc;
        }
    </style>




                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2023/02/27/next-image-是收费的/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2021/10/21/动手搭建翻译协作平台/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
  <!-- Top bar -->
  <div class="top-bar"></div>

  <!-- Sidebar toggle button -->
  <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;"
    data-upgraded=",MaterialButton,MaterialRipple">
    <i class="material-icons">clear_all</i>
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </button>

  <!-- Sidebar Avatar -->
  <div class="sidebar-image">
    <img src="/img/avatar.png" alt="jiandandkl's avatar">
  </div>

  <!-- Sidebar Email -->
  <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
    dujunnr@hotmail.com
    <b class="caret"></b>
  </a>
</div>

        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:dujunnr@hotmail.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
                <li>
                    <a href="https://github.com/jiandandkl" target="_blank" title="GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">home</i>
                        
                        GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2025/07/">七月 2025<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/12/">十二月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/04/">四月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/02/">二月 2023<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2022/05/">五月 2022<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/10/">十月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/05/">五月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/12/">十二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/01/">一月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/08/">八月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/06/">六月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/03/">三月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/01/">一月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/06/">六月 2018<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
  
  <!-- Paradox Footer Left Section -->
  <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="https://weibo.com/u/1676955787" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-weibo.svg);">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/jiandandkl" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.svg);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


  <!--Copyright-->
  <div id="copyright">
    Copyright&nbsp;©&nbsp;
    <script type="text/javascript">
      var fd = new Date();
      document.write(fd.getFullYear());
    </script>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    &nbsp;
    dujun blog
  </div>

  <!-- Paradox Footer Right Section -->

  <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

  <div class="mdl-mini-footer--right-section">
    <div>
      <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
      <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank"
          class="footer-develop-a">Material</a></div>
    </div>
  </div>
  
</footer>

                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>












    <!-- 使用 DISQUS js 代码 -->
    <script id="dsq-count-scr" src="//jiandandkl.disqus.com/count.js" async></script>





<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setTimeout(function(){
            setInterval(function(){
                queue.execNext();
            },200);
        },3000);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
